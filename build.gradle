plugins {
	id 'groovy'
	id 'com.github.johnrengelman.shadow' version '1.2.0'
}

repositories {
	mavenCentral()
}

dependencies {
	compile 'com.datastax.cassandra:cassandra-driver-core:2.1.4'
	compile "org.codehaus.groovy:groovy-all:2.4.0"
}

task run (dependsOn: 'classes', type: JavaExec) {
    main = 'physicalgraph.migration.Migrate'
	systemProperties = [host:host, port:port, keyspace:keyspace, migrationPath:migrationsPath]
    classpath = sourceSets.main.runtimeClasspath
}

task markAll (dependsOn: 'classes', type: JavaExec) {
    main = 'physicalgraph.migration.MarkAll'
	systemProperties = [host:host, port:port, keyspace:keyspace, migrationPath:migrationsPath]
    classpath = sourceSets.main.runtimeClasspath
}

shadowJar {
	archiveName "cassandra-migration-all.jar"
}
task release(type: Zip, dependsOn:shadowJar) {
	from("$buildDir/libs"){
		into "build/libs"
	}
	from("bin") {
		into "bin"
	}
	
	destinationDir file("$buildDir/release")
	archiveName "cassandra-migration-${version}.zip"
}
